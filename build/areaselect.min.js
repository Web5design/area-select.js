/**
*  area-select.js
*  A simple js class to select rectabgular regions in DOM elements (image, canvas, video, etc..)
*
*  https://github.com/foo123/area-select.js
*
*  @author: Nikos M.  http://nikos-web-development.netai.net/
*
**/!function(e){function t(e){var t=document.createElement("div");return e&&(t.className=e),t}function n(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function o(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}function l(e){e.draggable=!1,e.onmousedown=function(e){return e.preventDefault(),!1}}var s=Math.abs,i=100,r=e,c=function(e,l){l=l||{};var s=this;this.setElement(e),this.selection=null;var c=this.domElement=t(l.className||"img-area-select");c.style.position="absolute",c.style.display="none",c.style.zIndex=l.zIndex||100,c.style.left="0px",c.style.top="0px",c.style.width="0px",c.style.height="0px",this.container.appendChild(c);var u,f=0,h=0,a=0,d=0,p=0,y=0,m=function(e){e=e||r.event;var t=s.el,o=t,l=o.currentStyle||r.getComputedStyle(o,null),i=parseInt(l.borderLeftWidth,10),p=parseInt(l.borderTopWidth,10),y=o.getBoundingClientRect();return a=e.clientX-i-y.left,d=e.clientY-p-y.top,0>a?a=0:a>t.offsetWidth&&(a=t.offsetWidth),0>d?d=0:d>t.offsetHeight&&(d=t.offsetHeight),f=0,h=0,u=t.style.cursor,t.style.cursor=c.style.cursor="se-resize",c.style.display="block",c.style.left=t.offsetLeft-t.scrollLeft+a+"px",c.style.top=t.offsetTop-t.scrollTop+d+"px",c.style.width=f+"px",c.style.height=h+"px",n(t,"mousemove",v),n(t,"mouseup",x),n(c,"mousemove",v),n(c,"mouseup",x),!1},v=function(e){e=e||r.event;var t=s.el,n="e",o="s",l=t,i=l.currentStyle||r.getComputedStyle(l,null),u=parseInt(i.borderLeftWidth,10),m=parseInt(i.borderTopWidth,10),v=l.getBoundingClientRect();return p=e.clientX-u-v.left,y=e.clientY-m-v.top,0>p?p=0:p>t.offsetWidth&&(p=t.offsetWidth),0>y?y=0:y>t.offsetHeight&&(y=t.offsetHeight),a>p?(c.style.left=t.offsetLeft-t.scrollLeft+p+"px",f=a-p,n="w"):(p==a&&(n=""),c.style.left=t.offsetLeft-t.scrollLeft+a+"px",f=p-a),d>y?(c.style.top=t.offsetTop-t.scrollTop+y+"px",h=d-y,o="n"):(y==d&&(o=""),c.style.top=t.offsetTop-t.scrollTop+d+"px",h=y-d),c.style.width=f+"px",c.style.height=h+"px",t.style.cursor=c.style.cursor=o+n+"-resize",!1},x=function(e){return e=e||r.event,s.selection={x1:a>p?p:a,y1:d>y?y:d,x2:p>a?p:a,y2:y>d?y:d},a=d=p=y=f=h=0,s.el.style.cursor=u,c.style.cursor="auto",o(s.el,"mousemove",v),o(s.el,"mouseup",x),o(c,"mousemove",v),o(c,"mouseup",x),setTimeout(function(){s.callback&&s.callback.call(s,s.getSelection())},i),!1};l.onSelection&&this.onSelection(l.onSelection),n(s.el,"mousedown",m),n(c,"mousedown",m)};c.prototype={constructor:c,el:null,container:null,domElement:null,selection:null,callback:null,setElement:function(e){return this.el=e,l(this.el),this.container=this.el.parentNode,this},refresh:function(){return this.container=this.el.parentNode,this},showSelection:function(){return this.domElement.style.display="block",this},hideSelection:function(){return this.domElement.style.display="none",this},getSelection:function(){var e=this.selection;return e?{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,width:s(e.x2-e.x1),height:s(e.y2-e.y1)}:null},onSelection:function(e){return this.callback=e,this},deselect:function(){return this.selection=null,this.hideSelection()}},e.AreaSelect=c}(window);