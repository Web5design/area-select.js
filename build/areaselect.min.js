/**
*  area-select.js
*  A simple js class to select rectabgular regions in DOM elements (image, canvas, video, etc..)
*
*  https://github.com/foo123/area-select.js
*
*  @author: Nikos M.  http://nikos-web-development.netai.net/
*
**/!function(e,t){function n(e){var t=document.createElement("div");return e&&(t.className=e),t}function o(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,n)}function l(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n)}function s(e){e.draggable=!1,e.onmousedown=function(e){return e.preventDefault(),!1}}var i=Math.abs,r=(Math.min,100),c=e,u=function(e,s){s=s||{};var i=this;this.setElement(e),this.selection=null;var u=this.domElement=n(s.className||"img-area-select");u.style.position="absolute",u.style.display="none",u.style.zIndex=s.zIndex||100,u.style.left="0px",u.style.top="0px",u.style.width="0px",u.style.height="0px",this.container.appendChild(u);var f,h=0,a=0,d=0,p=0,y=0,m=0,v=t!==s.withBorders?s.withBorders:!0,x=function(e){e=e||c.event;var t=i.el,n=t.currentStyle||c.getComputedStyle(t,null),l=v?parseInt(n.borderLeftWidth,10):0,s=v?parseInt(n.borderTopWidth,10):0,r=t.getBoundingClientRect();return d=e.clientX-l-r.left,p=e.clientY-s-r.top,0>d?d=0:d>=t.offsetWidth&&(d=t.offsetWidth-1),0>p?p=0:p>=t.offsetHeight&&(p=t.offsetHeight-1),h=0,a=0,f=t.style.cursor,t.style.cursor=u.style.cursor="se-resize",u.style.display="block",u.style.left=t.offsetLeft-t.scrollLeft+d+"px",u.style.top=t.offsetTop-t.scrollTop+p+"px",u.style.width=h+"px",u.style.height=a+"px",o(t,"mousemove",g),o(t,"mouseup",E),o(u,"mousemove",g),o(u,"mouseup",E),!1},g=function(e){e=e||c.event;var t,n,o=i.el,l=o.currentStyle||c.getComputedStyle(o,null),s=v?parseInt(l.borderLeftWidth,10):0,r=v?parseInt(l.borderTopWidth,10):0,f=o.getBoundingClientRect(),x="e",g="s";return y=e.clientX-s-f.left,m=e.clientY-r-f.top,0>y?y=0:y>=o.offsetWidth&&(y=o.offsetWidth-1),0>m?m=0:m>=o.offsetHeight&&(m=o.offsetHeight-1),d>y?(t=y,u.style.left=o.offsetLeft-o.scrollLeft+y+"px",h=d-y,x="w"):(y==d&&(x=""),t=d,u.style.left=o.offsetLeft-o.scrollLeft+d+"px",h=y-d),p>m?(n=m,u.style.top=o.offsetTop-o.scrollTop+m+"px",a=p-m,g="n"):(m==p&&(g=""),n=p,u.style.top=o.offsetTop-o.scrollTop+p+"px",a=m-p),t+h>o.offsetWidth&&(h=o.offsetWidth-t-1),n+a>o.offsetHeight&&(a=o.offsetHeight-n-1),u.style.width=h+"px",u.style.height=a+"px",o.style.cursor=u.style.cursor=g+x+"-resize",!1},E=function(e){return e=e||c.event,i.selection={x1:d>y?y:d,y1:p>m?m:p,x2:y>d?y:d,y2:m>p?m:p},d=p=y=m=h=a=0,i.el.style.cursor=f,u.style.cursor="auto",l(i.el,"mousemove",g),l(i.el,"mouseup",E),l(u,"mousemove",g),l(u,"mouseup",E),setTimeout(function(){i.callback&&i.callback.call(i,i.getSelection())},r),!1};s.onSelection&&this.onSelection(s.onSelection),o(i.el,"mousedown",x),o(u,"mousedown",x)};u.prototype={constructor:u,el:null,container:null,domElement:null,selection:null,callback:null,setElement:function(e){return this.el=e,s(this.el),this.container=this.el.parentNode,this},refresh:function(){return this.container=this.el.parentNode,this},showSelection:function(){return this.domElement.style.display="block",this},hideSelection:function(){return this.domElement.style.display="none",this},getSelection:function(){var e=this.selection;return e?{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,width:i(e.x2-e.x1),height:i(e.y2-e.y1)}:null},onSelection:function(e){return this.callback=e,this},deselect:function(){return this.selection=null,this.hideSelection()}},e.AreaSelect=u}(window);