/**
*  area-select.js
*  A simple js class to select rectabgular regions in DOM elements (image, canvas, video, etc..)
*
*  https://github.com/foo123/area-select.js
*
*  @author: Nikos M.  http://nikos-web-development.netai.net/
*
**/!function(e){function t(e){var t=document.createElement("div");return e&&(t.className=e),t}function n(e,t){var n;document.createEvent?(n=document.createEvent("HTMLEvents"),n.initEvent(t,!0,!0)):(n=document.createEventObject(),n.eventType=t),n.eventName=t,document.createEvent?e.dispatchEvent(n):e.fireEvent("on"+n.eventType,n)}function l(e){e.draggable=!1,e.onmousedown=function(e){return e.preventDefault(),!1}}var o=Math.abs,s=100,i=function(e,l){l=l||{};var o=this;this.setElement(e),this.selection={x1:null,y1:null,x2:null,y2:null};var i=this.domElement=t(l.className||"img-area-select");i.style.position="absolute",i.style.display="none",i.style.zIndex=l.zIndex||100,i.style.left="0px",i.style.top="0px",i.style.width="0px",i.style.height="0px",this.container.appendChild(i);var c,r=0,u=0,a=0,h=0,d=0,y=0,p=function(e){return a=e.clientX-o.rect.left-o.el.clientLeft+o.el.scrollLeft,h=e.clientY-o.rect.top-o.el.clientTop+o.el.scrollTop,r=0,u=0,c=o.el.style.cursor||"auto",o.el.style.cursor=i.style.cursor="se-resize",i.style.display="block",i.style.left=o.el.offsetLeft+a+"px",i.style.top=o.el.offsetTop+h+"px",i.style.width=r+"px",i.style.height=u+"px",o.el.addEventListener("mousemove",f,!1),o.el.addEventListener("mouseup",m,!1),!1},f=function(e){var t="e",n="s";return d=e.clientX-o.rect.left-o.el.clientLeft+o.el.scrollLeft,y=e.clientY-o.rect.top-o.el.clientTop+o.el.scrollTop,a>d?(r=a-d,i.style.left=o.el.offsetLeft+d+"px",t="w"):(d==a&&(t=""),r=d-a),h>y?(u=h-y,i.style.top=o.el.offsetTop+y+"px",n="n"):(y==h&&(n=""),u=y-h),i.style.width=r+"px",i.style.height=u+"px",o.el.style.cursor=i.style.cursor=n+t+"-resize",!1},m=function(){return o.selection={x1:a>d?d:a,y1:h>y?y:h,x2:d>a?d:a,y2:y>h?y:h},a=h=d=y=r=u=0,o.el.style.cursor=c,i.style.cursor="auto",o.el.removeEventListener("mousemove",f),o.el.removeEventListener("mouseup",m),setTimeout(function(){o.callback&&o.callback.call(o,o.getSelection())},s),!1},v=function(){return n(o.el,"mousedown"),!1},x=function(){return n(o.el,"mouseup"),!1};l.onSelection&&this.onSelection(l.onSelection),this.el.addEventListener("mousedown",p,!1),i.addEventListener("mousedown",v,!1),i.addEventListener("mouseup",x,!1)};i.prototype={constructor:i,el:null,container:null,rect:null,domElement:null,selection:null,callback:null,setElement:function(e){return this.el=e,l(this.el),this.container=this.el.parentNode,this.rect=this.el.getBoundingClientRect(),this},refresh:function(){return this.container=this.el.parentNode,this.rect=this.el.getBoundingClientRect(),this},showSelection:function(){return this.domElement.style.display="block",this},hideSelection:function(){return this.domElement.style.display="none",this},getSelection:function(){var e=this.selection;return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,width:o(e.x2-e.x1),height:o(e.y2-e.y1)}},onSelection:function(e){return this.callback=e,this},deselect:function(){return this.selection={x1:null,y1:null,x2:null,y2:null},this.hideSelection()}},e.AreaSelect=i}(window);